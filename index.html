<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ina ðŸ’˜ Valentine</title>

  <style>
    :root{
      /* Big overall sizing */
      --card-pad: clamp(28px, 4vw, 52px);
      --card-radius: 24px;
      --h1-size: clamp(28px, 3.2vw, 44px);
      --btn-size: clamp(16px, 2vw, 22px);
      --btn-pad-y: clamp(12px, 1.7vw, 18px);
      --btn-pad-x: clamp(18px, 2.2vw, 28px);
      --shadow: 0 18px 55px rgba(0,0,0,.16);
    }

    body{
      margin:0;
      height:100vh;
      display:grid;
      place-items:center;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background: linear-gradient(135deg, #ffe3ec, #fff7d6);
      overflow:hidden;
    }

    /* Floating hearts background layer */
    #hearts {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
      overflow: hidden;
    }

    .heart {
      position: absolute;
      bottom: -60px;
      width: 18px;
      height: 18px;
      transform: rotate(45deg);
      opacity: 0.8;
      filter: blur(0.1px);
      animation: floatUp linear forwards;
    }

    .heart::before,
    .heart::after{
      content:"";
      position:absolute;
      width: 18px;
      height: 18px;
      border-radius: 50%;
    }

    .heart::before{ left: -9px; top: 0; }
    .heart::after { left: 0; top: -9px; }

    @keyframes floatUp {
      0%   { transform: translateY(0) rotate(45deg) scale(1); opacity: 0; }
      10%  { opacity: 0.85; }
      100% { transform: translateY(-120vh) rotate(45deg) scale(1.3); opacity: 0; }
    }

    /* Main UI card */
    .card{
      position: relative;
      z-index: 2;
      background:#fff;
      padding: var(--card-pad);
      border-radius: var(--card-radius);
      box-shadow: var(--shadow);
      text-align:center;
      width: min(720px, calc(100vw - 28px));
    }

    h1{
      margin:0 0 18px;
      font-size: var(--h1-size);
      line-height: 1.15;
      letter-spacing: -0.02em;
    }

    .sub{
      margin: 0 0 22px;
      font-size: clamp(14px, 1.5vw, 18px);
      opacity: 0.8;
    }

    #area{
      position: relative;
      height: clamp(78px, 10vw, 110px);
      margin-top: 8px;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      gap: 14px;
    }

    button{
      border:0;
      padding: var(--btn-pad-y) var(--btn-pad-x);
      border-radius: 16px;
      font-size: var(--btn-size);
      cursor:pointer;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
      transition: transform .18s ease, filter .15s ease, box-shadow .18s ease;
      box-shadow: 0 10px 22px rgba(0,0,0,.10);
      will-change: transform;
    }

    #yes{
      background:#22c55e;
      color:#fff;
      transform-origin: center;
    }
    #yes:hover{ filter: brightness(1.06); }
    #yes:active{ transform: scale(0.98); }

    /* Pulse + glow when growing */
    #yes.growing{
      animation: yesPulse 1.2s ease-in-out infinite;
      box-shadow: 0 12px 30px rgba(34,197,94,.35);
    }
    @keyframes yesPulse{
      0%, 100% { filter: brightness(1); }
      50%      { filter: brightness(1.12); }
    }

    #no{
      background:#ef4444;
      color:#fff;
      position:absolute;
      left: 60%;
      top: 0;
      will-change: left, top, transform;
    }

    /* Shake effect when you get close */
    #no.shake{
      animation: shake .12s infinite linear;
    }
    @keyframes shake{
      0%{ transform: translate(0,0) rotate(0deg); }
      25%{ transform: translate(2px,-1px) rotate(0.3deg); }
      50%{ transform: translate(-2px,1px) rotate(-0.3deg); }
      75%{ transform: translate(1px,2px) rotate(0.2deg); }
      100%{ transform: translate(0,0) rotate(0deg); }
    }

    /* Confetti canvas */
    #confetti{
      position: fixed;
      inset: 0;
      pointer-events:none;
      z-index: 3;
    }

    /* Modal */
    .backdrop{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.35);
      display:none;
      place-items:center;
      z-index: 4;
    }
    .backdrop.show{ display:grid; }

    .modal{
      background:#fff;
      width: min(560px, calc(100vw - 32px));
      border-radius: 24px;
      box-shadow: var(--shadow);
      padding: 26px 24px;
      text-align:center;
    }

    .photo{
      width: 100%;
      max-height: 360px;
      object-fit: cover;
      border-radius: 22px;
      margin: 16px 0 12px;
      box-shadow: 0 14px 32px rgba(0,0,0,.16);
    }

    .modal h2{
      margin: 10px 0 10px;
      font-size: clamp(22px, 2.4vw, 34px);
    }
    .modal p{
      margin: 0 0 16px;
      font-size: clamp(15px, 1.7vw, 20px);
      opacity: 0.85;
    }
    .modal button{
      background:#111827;
      color:#fff;
      border-radius: 16px;
      padding: 12px 18px;
      font-size: clamp(15px, 1.7vw, 18px);
    }
  </style>
</head>

<body>
  <div id="hearts"></div>
  <canvas id="confetti"></canvas>

  <div class="card">
    <h1 id="headline"></h1>
    <p class="sub">it seems a shy No appeared ðŸ˜‡</p>

    <div id="area">
      <button id="yes">Yes</button>
      <button id="no">No</button>
    </div>
  </div>

  <div class="backdrop" id="backdrop" role="dialog" aria-modal="true">
    <div class="modal">
      <div style="font-size:42px; line-height:1;">ðŸ’–</div>

      <!-- Photo hosted in repo root -->
      <img src="us.jpg?v=1" alt="Us together" class="photo" />

      <h2>Yay, great decision!</h2>
      <p>Best Valentine ever ðŸ¥°</p>
      <button id="closeModal">Close</button>
    </div>
  </div>

  <script>
    // ---------------------------
    // (4) Typing headline
    // ---------------------------
    const headlineEl = document.getElementById("headline");
    const fullText = "Bubu, will you be my Valentine? ðŸ’˜";
    let idx = 0;

    function typeTick(){
      headlineEl.textContent = fullText.slice(0, idx++);
      if (idx <= fullText.length) setTimeout(typeTick, 45);
    }
    typeTick();

    // ---------------------------
    // (1) Floating hearts background
    // ---------------------------
    const heartsLayer = document.getElementById("hearts");
    const heartColors = ["#ff4d6d", "#ff758f", "#ff9aa2", "#ff5c8a", "#ff3d6e"];

    function spawnHeart(){
      const h = document.createElement("div");
      h.className = "heart";

      const size = 10 + Math.random() * 18; // 10..28
      h.style.width = size + "px";
      h.style.height = size + "px";

      const c = heartColors[Math.floor(Math.random() * heartColors.length)];
      h.style.left = (Math.random() * 100) + "vw";
      h.style.animationDuration = (6 + Math.random() * 6) + "s";
      h.style.animationDelay = (Math.random() * 0.5) + "s";
      h.style.opacity = (0.25 + Math.random() * 0.55).toFixed(2);

      h.style.setProperty("color", c);
      h.style.setProperty("transform", `rotate(45deg) scale(${size/18})`);
      h.style.filter = `blur(${Math.random()*0.35}px)`;

      heartsLayer.appendChild(h);
      setTimeout(() => h.remove(), 13000);
    }

    (function patchHeartColor(){
      const style = document.createElement("style");
      style.textContent = `
        .heart { background: currentColor; }
        .heart::before, .heart::after { background: currentColor; }
      `;
      document.head.appendChild(style);
    })();

    setInterval(() => {
      spawnHeart();
      if (Math.random() < 0.6) spawnHeart();
    }, 420);

    // ---------------------------
    // Buttons / modal refs
    // ---------------------------
    const area = document.getElementById("area");
    const noBtn = document.getElementById("no");
    const yesBtn = document.getElementById("yes");
    const backdrop = document.getElementById("backdrop");
    const closeModalBtn = document.getElementById("closeModal");

    function clamp(v, min, max){ return Math.min(Math.max(v, min), max); }

    // ---------------------------
    // (2) Smart "No" button: shake + speed ramp
    // ---------------------------
    function placeNoRandom(){
      const maxX = area.clientWidth - noBtn.offsetWidth;
      const maxY = area.clientHeight - noBtn.offsetHeight;
      noBtn.style.left = `${Math.random() * Math.max(0, maxX)}px`;
      noBtn.style.top  = `${Math.random() * Math.max(0, maxY)}px`;
    }

    function dodgeAway(e){
      const btnRect = noBtn.getBoundingClientRect();

      const btnX = btnRect.left + btnRect.width / 2;
      const btnY = btnRect.top  + btnRect.height / 2;

      const dx = btnX - e.clientX;
      const dy = btnY - e.clientY;

      const dist = Math.hypot(dx, dy);

      const panicRadius = 190;
      const shakeRadius = 140;

      if (dist < shakeRadius) noBtn.classList.add("shake");
      else noBtn.classList.remove("shake");

      if (dist > panicRadius) return;

      const minDist = 40;
      const t = clamp((panicRadius - dist) / (panicRadius - minDist), 0, 1);
      const jump = 90 + t * 180;

      const safeDist = Math.max(dist, 0.001);
      const nx = dx / safeDist;
      const ny = dy / safeDist;

      let newLeft = noBtn.offsetLeft + nx * jump;
      let newTop  = noBtn.offsetTop  + ny * jump;

      const maxX = area.clientWidth  - btnRect.width;
      const maxY = area.clientHeight - btnRect.height;

      newLeft = clamp(newLeft, 0, maxX);
      newTop  = clamp(newTop,  0, maxY);

      if ((newLeft === 0 || newLeft === maxX) && (newTop === 0 || newTop === maxY)) {
        newLeft = Math.random() * Math.max(0, maxX);
        newTop  = Math.random() * Math.max(0, maxY);
      }

      noBtn.style.left = `${newLeft}px`;
      noBtn.style.top  = `${newTop}px`;
    }

    window.addEventListener("mousemove", dodgeAway);
    window.addEventListener("touchmove", (ev) => dodgeAway(ev.touches[0]), { passive:true });
    noBtn.addEventListener("mouseenter", placeNoRandom);
    noBtn.addEventListener("click", placeNoRandom);
    requestAnimationFrame(placeNoRandom);
    window.addEventListener("resize", () => setTimeout(placeNoRandom, 50));

    // ---------------------------
    // (NEW) Yes button grows + slides toward center + glows/pulses
    // ---------------------------
    let yesScale = 1;
    let growthSpeed = 0.050;     // initial growth amount per tick
    let growthAccel = 0.0018;    // acceleration per tick
    let slideT = 0;              // 0..1 progress for sliding toward center
    let yesGrowTimer = null;

    function getYesCenterTargetX(){
      // Move the YES button toward the horizontal center of the area
      const areaRect = area.getBoundingClientRect();
      const yesRect = yesBtn.getBoundingClientRect();
      const yesHalf = yesRect.width / 2;
      const centerX = (areaRect.width / 2) - yesHalf; // target left within area coords
      return centerX;
    }

    function startYesGrowth(){
      yesBtn.classList.add("growing");
      yesGrowTimer = setInterval(() => {
        // scale
        yesScale += growthSpeed;
        growthSpeed += growthAccel;

        // cap scale
        yesScale = Math.min(yesScale, 2.3);

        // slide toward center gradually (ease)
        slideT = Math.min(1, slideT + 0.03);

        // compute current translateX needed to move toward center
        const yesLeftInArea = yesBtn.offsetLeft; // relative to area
        const targetLeft = getYesCenterTargetX();
        const desiredDx = targetLeft - yesLeftInArea;

        // apply partial movement
        const dx = desiredDx * slideT;

        // apply transform
        yesBtn.style.transform = `translateX(${dx}px) scale(${yesScale})`;

        // stop once maxed out for a while
        if (yesScale >= 2.3 && slideT >= 1) {
          // keep pulsing/glow but stop growing further
          clearInterval(yesGrowTimer);
          yesGrowTimer = null;
        }
      }, 900);
    }

    // start growing immediately
    startYesGrowth();

    // keep movement stable if window resizes
    window.addEventListener("resize", () => {
      // nudges target recalculation next tick; if timer already stopped, re-apply transform
      if (!yesGrowTimer) {
        slideT = 1;
        const yesLeftInArea = yesBtn.offsetLeft;
        const targetLeft = getYesCenterTargetX();
        const dx = (targetLeft - yesLeftInArea) * slideT;
        yesBtn.style.transform = `translateX(${dx}px) scale(${yesScale})`;
      }
    });

    // ---------------------------
    // Modal
    // ---------------------------
    function openModal(){ backdrop.classList.add("show"); }
    function closeModal(){ backdrop.classList.remove("show"); }

    closeModalBtn.addEventListener("click", closeModal);
    backdrop.addEventListener("click", (e) => { if (e.target === backdrop) closeModal(); });
    window.addEventListener("keydown", (e) => {
      if (e.key === "Escape" && backdrop.classList.contains("show")) closeModal();
    });

    // ---------------------------
    // (3) Heart-shaped confetti (canvas)
    // ---------------------------
    const canvas = document.getElementById("confetti");
    const ctx = canvas.getContext("2d");

    function resizeCanvas(){
      canvas.width = innerWidth * devicePixelRatio;
      canvas.height = innerHeight * devicePixelRatio;
      ctx.setTransform(devicePixelRatio, 0, 0, devicePixelRatio, 0, 0);
    }
    addEventListener("resize", resizeCanvas);
    resizeCanvas();

    const confettiColors = ["#ff3d6e","#ff5c8a","#ff758f","#ff9aa2","#f43f5e","#fb7185","#ec4899"];
    let pieces = [];
    let running = false;

    function rand(min,max){ return Math.random()*(max-min)+min; }
    function pick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }

    function drawHeart(x, y, size, rot){
      ctx.save();
      ctx.translate(x, y);
      ctx.rotate(rot);

      const s = size / 18;
      ctx.scale(s, s);

      ctx.beginPath();
      ctx.moveTo(0, 6);
      ctx.bezierCurveTo(0, -3, -12, -3, -12, 6);
      ctx.bezierCurveTo(-12, 15, 0, 18, 0, 26);
      ctx.bezierCurveTo(0, 18, 12, 15, 12, 6);
      ctx.bezierCurveTo(12, -3, 0, -3, 0, 6);
      ctx.closePath();
      ctx.fill();

      ctx.restore();
    }

    function burstHearts(n=220){
      for(let i=0;i<n;i++){
        pieces.push({
          x: rand(0, innerWidth),
          y: rand(-40, -10),
          vx: rand(-1.8, 1.8),
          vy: rand(2.2, 5.5),
          size: rand(10, 22),
          rot: rand(0, Math.PI*2),
          vr: rand(-0.14, 0.14),
          color: pick(confettiColors),
          life: rand(220, 380)
        });
      }
    }

    function confettiFrame(){
      if(!running) return;
      ctx.clearRect(0,0,innerWidth,innerHeight);

      for(const p of pieces){
        p.x += p.vx;
        p.y += p.vy;
        p.rot += p.vr;
        p.vy += 0.016;
        p.vx *= 0.999;
        p.life -= 1;

        ctx.fillStyle = p.color;
        drawHeart(p.x, p.y, p.size, p.rot);
      }

      pieces = pieces.filter(p => p.life > 0 && p.y < innerHeight + 60);

      if(pieces.length === 0){
        running = false;
        ctx.clearRect(0,0,innerWidth,innerHeight);
        return;
      }
      requestAnimationFrame(confettiFrame);
    }

    function startConfetti(){
      pieces = [];
      burstHearts(240);
      running = true;
      confettiFrame();
      setTimeout(() => burstHearts(160), 240);
    }

    // Yes click -> stop growth + modal + confetti
    yesBtn.addEventListener("click", () => {
      if (yesGrowTimer) clearInterval(yesGrowTimer);
      yesGrowTimer = null;
      yesBtn.classList.remove("growing");

      // keep it big & centered as a little victory moment
      slideT = 1;
      const yesLeftInArea = yesBtn.offsetLeft;
      const targetLeft = getYesCenterTargetX();
      const dx = (targetLeft - yesLeftInArea) * slideT;
      yesBtn.style.transform = `translateX(${dx}px) scale(${Math.min(yesScale, 2.3)})`;

      openModal();
      startConfetti();
    });
  </script>
</body>
</html>
